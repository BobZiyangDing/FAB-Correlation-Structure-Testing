"0","FAB_ps <- matrix(0, p, p)"
"0","UMPU_ps <- matrix(0, p, p)"
"0","  "
"0","for(idx in 1:num_groups){"
"0","  group_subset <- subset(group_idx, group_idx==idx)"
"0","  group_direct_F_r <- get_group_F_r(group_subset, F_r)"
"0","  group_indirect_F_r <- get_group_F_r(group_subset, F_r_ref)"
"0","  "
"0","  group_p <- dim(group_subset)[1]"
"0","  "
"0","  for(j in 1:group_p){"
"0","    group_indirect_info <- group_indirect_F_r[-j]"
"0","    mu_MLE <- mean(group_indirect_info)"
"0","    psi2_MLE <- group_p/(group_p-1)*var(group_indirect_info) - 1/(ref_n-3) + 0.5"
"0","    "
"0","    tilde_m <- mu_MLE"
"0","    tilde_v <- psi2_MLE"
"0","    "
"0","    fab_p <- 1 - abs(pnorm(group_direct_F_r[j]*sqrt(n-3) + 2*tilde_m*sqrt(ref_n-3)/tilde_v , 0, 1) - "
"0","                       pnorm(-group_direct_F_r[j]*sqrt(n-3), 0, 1) )"
"0","    umpu_p <- 1 - abs(pnorm(group_direct_F_r[j]*sqrt(n-3) , 0, 1) - "
"0","                        pnorm(-group_direct_F_r[j]*sqrt(n-3), 0, 1) )"
"0","    "
"0","    row_idx = group_subset$row_idx[j]"
"0","    col_idx = group_subset$col_idx[j]"
"0","    FAB_ps[row_idx, col_idx] = fab_p"
"0","    FAB_ps[col_idx, row_idx] = fab_p"
"0","    UMPU_ps[row_idx, col_idx] = umpu_p"
"0","    UMPU_ps[col_idx, row_idx] = umpu_p"
"0","  }"
"0","  if(idx %% 100 == 0){"
"0","    print(idx)"
"0","  }"
"0","}"
